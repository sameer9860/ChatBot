<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EduBot â€” NLTK Learning Assistant</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0c0f1a;
    --surface: #141828;
    --surface2: #1c2236;
    --border: #252d45;
    --accent: #4f8ef7;
    --accent2: #7c5cfc;
    --green: #34d399;
    --yellow: #fbbf24;
    --red: #f87171;
    --text: #e8ecf4;
    --muted: #6b7494;
    --tag-bg: rgba(79,142,247,0.12);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Inter', sans-serif;
    background: var(--bg);
    background-image:
      radial-gradient(ellipse 80% 50% at 10% 0%, rgba(79,142,247,0.08) 0%, transparent 60%),
      radial-gradient(ellipse 60% 40% at 90% 100%, rgba(124,92,252,0.08) 0%, transparent 60%);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 28px 16px 40px;
    color: var(--text);
  }

  /* â”€â”€ HEADER â”€â”€ */
  header {
    width: 100%;
    max-width: 780px;
    display: flex;
    align-items: center;
    gap: 14px;
    margin-bottom: 20px;
    animation: fadeUp 0.5s ease both;
  }

  .logo {
    width: 48px; height: 48px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 14px;
    display: flex; align-items: center; justify-content: center;
    font-size: 22px;
    box-shadow: 0 4px 20px rgba(79,142,247,0.35);
    flex-shrink: 0;
  }

  .header-info h1 {
    font-family: 'Syne', sans-serif;
    font-size: 1.6rem;
    font-weight: 800;
    background: linear-gradient(90deg, var(--accent), var(--accent2));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    letter-spacing: -0.02em;
  }

  .header-info p {
    font-size: 0.75rem;
    color: var(--muted);
    margin-top: 2px;
    font-family: 'JetBrains Mono', monospace;
  }

  .engine-badge {
    margin-left: auto;
    background: rgba(52,211,153,0.1);
    border: 1px solid rgba(52,211,153,0.25);
    color: var(--green);
    font-size: 0.72rem;
    padding: 5px 12px;
    border-radius: 20px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 6px;
    font-family: 'JetBrains Mono', monospace;
    white-space: nowrap;
  }

  .dot { width: 6px; height: 6px; border-radius: 50%; background: var(--green); animation: pulse 2s infinite; }

  /* â”€â”€ TOPIC CHIPS â”€â”€ */
  .chips {
    width: 100%;
    max-width: 780px;
    display: flex;
    flex-wrap: wrap;
    gap: 7px;
    margin-bottom: 16px;
    animation: fadeUp 0.5s ease 0.08s both;
  }

  .chip {
    font-size: 0.73rem;
    padding: 5px 12px;
    border-radius: 20px;
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--muted);
    cursor: pointer;
    font-weight: 500;
    transition: all 0.18s;
  }

  .chip:hover {
    background: var(--tag-bg);
    border-color: rgba(79,142,247,0.4);
    color: var(--accent);
    transform: translateY(-1px);
  }

  /* â”€â”€ MAIN LAYOUT â”€â”€ */
  .layout {
    width: 100%;
    max-width: 780px;
    display: flex;
    gap: 14px;
    animation: fadeUp 0.5s ease 0.15s both;
  }

  /* â”€â”€ SIDEBAR â”€â”€ */
  .sidebar {
    width: 200px;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .sidebar-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 14px;
  }

  .sidebar-card h3 {
    font-size: 0.68rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--muted);
    margin-bottom: 10px;
  }

  .subject-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100%;
    background: none;
    border: none;
    color: var(--text);
    font-size: 0.8rem;
    padding: 7px 8px;
    border-radius: 8px;
    cursor: pointer;
    text-align: left;
    transition: all 0.15s;
    font-family: 'Inter', sans-serif;
  }

  .subject-btn:hover {
    background: var(--tag-bg);
    color: var(--accent);
  }

  .stats-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 5px 0;
    border-bottom: 1px solid var(--border);
    font-size: 0.75rem;
  }

  .stats-row:last-child { border-bottom: none; }
  .stats-label { color: var(--muted); }
  .stats-value { color: var(--text); font-weight: 600; font-family: 'JetBrains Mono', monospace; }

  /* â”€â”€ CHAT â”€â”€ */
  .chat-panel {
    flex: 1;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 18px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    height: 540px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.4);
  }

  .chat-topbar {
    padding: 12px 18px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 8px;
    background: var(--surface2);
  }

  .chat-topbar-dot {
    width: 8px; height: 8px; border-radius: 50%;
  }

  .messages {
    flex: 1;
    overflow-y: auto;
    padding: 20px 18px 10px;
    display: flex;
    flex-direction: column;
    gap: 14px;
    scroll-behavior: smooth;
  }

  .messages::-webkit-scrollbar { width: 4px; }
  .messages::-webkit-scrollbar-track { background: transparent; }
  .messages::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }

  /* â”€â”€ MESSAGES â”€â”€ */
  .msg {
    display: flex;
    gap: 10px;
    animation: msgPop 0.3s cubic-bezier(0.34,1.56,0.64,1) both;
  }

  .msg.user { flex-direction: row-reverse; }

  .avatar {
    width: 32px; height: 32px;
    border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
    font-size: 14px;
    flex-shrink: 0;
    margin-top: 2px;
  }

  .bot-av {
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    box-shadow: 0 2px 12px rgba(79,142,247,0.4);
  }

  .user-av { background: var(--surface2); border: 1px solid var(--border); }

  .bubble-wrap { max-width: 78%; display: flex; flex-direction: column; }
  .msg.user .bubble-wrap { align-items: flex-end; }

  .bubble {
    padding: 10px 14px;
    border-radius: 14px;
    font-size: 0.855rem;
    line-height: 1.65;
    white-space: pre-wrap;
    word-break: break-word;
  }

  .bot .bubble {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-bottom-left-radius: 4px;
    color: var(--text);
  }

  .user .bubble {
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    color: white;
    border-bottom-right-radius: 4px;
    font-weight: 500;
  }

  .meta {
    font-size: 0.63rem;
    color: var(--muted);
    margin-top: 4px;
    font-family: 'JetBrains Mono', monospace;
    display: flex;
    gap: 8px;
  }

  .tag-pill {
    background: var(--tag-bg);
    color: var(--accent);
    border-radius: 4px;
    padding: 0 5px;
    font-size: 0.6rem;
  }

  /* Typing */
  .typing { display: flex; gap: 10px; align-items: center; }

  .dots {
    padding: 10px 14px;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 14px;
    border-bottom-left-radius: 4px;
    display: flex;
    gap: 5px;
    align-items: center;
  }

  .dots span {
    width: 6px; height: 6px;
    background: var(--muted);
    border-radius: 50%;
    animation: bounce 1.1s infinite;
  }
  .dots span:nth-child(2) { animation-delay: 0.15s; }
  .dots span:nth-child(3) { animation-delay: 0.3s; }

  /* Welcome */
  .welcome {
    background: linear-gradient(135deg, #1a2545, #1e1a35);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 18px;
  }

  .welcome h2 {
    font-family: 'Syne', sans-serif;
    font-size: 1.1rem;
    margin-bottom: 6px;
    color: var(--text);
  }

  .welcome p { font-size: 0.8rem; color: var(--muted); line-height: 1.5; }

  .quick-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 7px;
    margin-top: 12px;
  }

  .quick-btn {
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 9px;
    padding: 7px 10px;
    font-size: 0.75rem;
    color: var(--text);
    cursor: pointer;
    transition: all 0.15s;
    font-family: 'Inter', sans-serif;
    text-align: left;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .quick-btn:hover {
    background: rgba(79,142,247,0.15);
    border-color: rgba(79,142,247,0.3);
    color: var(--accent);
  }

  /* â”€â”€ INPUT â”€â”€ */
  .input-area {
    padding: 14px 16px;
    border-top: 1px solid var(--border);
    display: flex;
    gap: 10px;
    align-items: flex-end;
    background: var(--surface2);
  }

  .input-box {
    flex: 1;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 10px 14px;
    transition: border-color 0.2s, box-shadow 0.2s;
  }

  .input-box:focus-within {
    border-color: rgba(79,142,247,0.5);
    box-shadow: 0 0 0 3px rgba(79,142,247,0.08);
  }

  textarea {
    width: 100%;
    border: none;
    background: transparent;
    font-family: 'Inter', sans-serif;
    font-size: 0.875rem;
    color: var(--text);
    resize: none;
    outline: none;
    min-height: 22px;
    max-height: 110px;
    line-height: 1.5;
  }

  textarea::placeholder { color: var(--muted); }

  .send-btn {
    width: 42px; height: 42px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border: none;
    border-radius: 12px;
    cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    font-size: 17px;
    color: white;
    transition: all 0.2s;
    box-shadow: 0 4px 16px rgba(79,142,247,0.35);
    flex-shrink: 0;
  }

  .send-btn:hover { transform: translateY(-1px); box-shadow: 0 6px 20px rgba(79,142,247,0.45); }
  .send-btn:active { transform: translateY(0); }
  .send-btn:disabled { opacity: 0.35; cursor: not-allowed; transform: none; }

  /* â”€â”€ ANIMATIONS â”€â”€ */
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(16px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @keyframes msgPop {
    from { opacity: 0; transform: scale(0.95) translateY(8px); }
    to { opacity: 1; transform: scale(1) translateY(0); }
  }

  @keyframes bounce {
    0%, 60%, 100% { transform: translateY(0); }
    30% { transform: translateY(-5px); }
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.4; transform: scale(0.85); }
  }

  /* Responsive */
  @media (max-width: 620px) {
    .sidebar { display: none; }
    .layout { flex-direction: column; }
    .chat-panel { height: 480px; }
  }
</style>
</head>
<body>

<header>
  <div class="logo">ğŸ“</div>
  <div class="header-info">
    <h1>EduBot</h1>
    <p>// NLTK-powered Â· bag-of-words + lemmatization</p>
  </div>
  <div class="engine-badge">
    <span class="dot"></span> NLTK Engine
  </div>
</header>

<div class="chips">
  <button class="chip" onclick="ask('What is calculus?')">ğŸ“ Calculus</button>
  <button class="chip" onclick="ask('Explain quantum mechanics')">âš›ï¸ Quantum</button>
  <button class="chip" onclick="ask('What is DNA?')">ğŸ§¬ DNA</button>
  <button class="chip" onclick="ask('What is machine learning?')">ğŸ¤– ML</button>
  <button class="chip" onclick="ask('Tell me about prime numbers')">ğŸ”¢ Primes</button>
  <button class="chip" onclick="ask('What is OOP?')">ğŸ’» OOP</button>
  <button class="chip" onclick="ask('World War 2')">ğŸ“œ WW2</button>
  <button class="chip" onclick="ask('What is gravity?')">ğŸŒ Gravity</button>
</div>

<div class="layout">

  <!-- Sidebar -->
  <div class="sidebar">
    <div class="sidebar-card">
      <h3>ğŸ“š Subjects</h3>
      <button class="subject-btn" onclick="ask('What topics are in mathematics?')">ğŸ“ Mathematics</button>
      <button class="subject-btn" onclick="ask('Explain physics topics')">âš—ï¸ Physics</button>
      <button class="subject-btn" onclick="ask('Chemistry topics')">ğŸ§ª Chemistry</button>
      <button class="subject-btn" onclick="ask('What is evolution?')">ğŸ§¬ Biology</button>
      <button class="subject-btn" onclick="ask('Computer science topics')">ğŸ’» Comp. Sci</button>
      <button class="subject-btn" onclick="ask('History topics')">ğŸ“œ History</button>
    </div>

    <div class="sidebar-card">
      <h3>âš™ï¸ Engine Info</h3>
      <div class="stats-row">
        <span class="stats-label">Engine</span>
        <span class="stats-value">NLTK</span>
      </div>
      <div class="stats-row">
        <span class="stats-label">Method</span>
        <span class="stats-value">BoW</span>
      </div>
      <div class="stats-row">
        <span class="stats-label">Topics</span>
        <span class="stats-value">30+</span>
      </div>
      <div class="stats-row">
        <span class="stats-label">Model</span>
        <span class="stats-value">None</span>
      </div>
      <div class="stats-row">
        <span class="stats-label">RAM</span>
        <span class="stats-value">~20MB</span>
      </div>
    </div>
  </div>

  <!-- Chat -->
  <div class="chat-panel">
    <div class="chat-topbar">
      <div class="chat-topbar-dot" style="background:#f87171"></div>
      <div class="chat-topbar-dot" style="background:#fbbf24"></div>
      <div class="chat-topbar-dot" style="background:#34d399"></div>
      <span style="font-size:0.75rem;color:var(--muted);margin-left:8px;font-family:'JetBrains Mono',monospace">edubot Â· nltk Â· localhost:5000</span>
    </div>

    <div class="messages" id="messages">
      <div class="welcome">
        <h2>ğŸ‘‹ Hello, I'm EduBot!</h2>
        <p>Powered entirely by NLTK â€” no heavy models, no GPU needed. I use <strong style="color:var(--accent)">tokenization, lemmatization & bag-of-words</strong> matching to answer your questions.</p>
        <div class="quick-grid">
          <button class="quick-btn" onclick="ask('What is the Pythagorean theorem?')">ğŸ“ Pythagorean Theorem</button>
          <button class="quick-btn" onclick="ask('Explain Newton laws of motion')">âš™ï¸ Newton's Laws</button>
          <button class="quick-btn" onclick="ask('What is DNA?')">ğŸ§¬ DNA Structure</button>
          <button class="quick-btn" onclick="ask('What are data structures?')">ğŸ’» Data Structures</button>
        </div>
      </div>
    </div>

    <div class="input-area">
      <div class="input-box">
        <textarea id="inp" placeholder="Ask an educational question..." rows="1"
          onkeydown="handleKey(event)" oninput="resize(this)"></textarea>
      </div>
      <button class="send-btn" id="sendBtn" onclick="sendMsg()" title="Send (Enter)">â¤</button>
    </div>
  </div>

</div>

<script>
// â”€â”€ Demo Knowledge Base (mirrors Python backend) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const KB = [
  { tag:"greeting", keys:["hello","hi","hey","howdy","greetings","morning","evening"],
    res:["Hello! ğŸ‘‹ I'm EduBot, powered by NLTK. Ask me anything about Math, Science, History, or CS!",
         "Hi there! Ready to learn? ğŸ“š Ask me any educational question!"] },
  { tag:"goodbye", keys:["bye","goodbye","see you","quit","exit"],
    res:["Goodbye! Keep learning! ğŸ“"] },
  { tag:"thanks", keys:["thank","thanks","appreciate","helpful"],
    res:["You're welcome! ğŸ˜Š Any other questions?"] },
  { tag:"capabilities", keys:["what can you do","help","topics","teach","know","capabilities"],
    res:["I can teach you:\nğŸ“ Mathematics â€” algebra, calculus, geometry, statistics\nâš—ï¸ Physics â€” mechanics, gravity, quantum, thermodynamics\nğŸ§ª Chemistry â€” atoms, periodic table, reactions\nğŸ§¬ Biology â€” cells, DNA, evolution, photosynthesis\nğŸ’» CS â€” algorithms, OOP, ML, data structures\nğŸ“œ History â€” world wars, civilizations, revolutions"] },

  // Math
  { tag:"calculus", keys:["calculus","derivative","integral","differentiation","integration","limit"],
    res:["ğŸ“ Calculus is the mathematics of continuous change.\n\nâ€¢ Differential Calculus: rates of change (derivatives)\n  e.g., velocity = d(position)/dt\nâ€¢ Integral Calculus: accumulation (integrals)\n  e.g., area under a curve\n\nKey rule: d/dx(xâ¿) = nxâ¿â»Â¹\nDeveloped by Newton and Leibniz in the 17th century."] },
  { tag:"pythagorean", keys:["pythagorean","pythagoras","right triangle","hypotenuse"],
    res:["ğŸ“ Pythagorean Theorem: aÂ² + bÂ² = cÂ²\n\nIn a right-angled triangle, the square of the hypotenuse equals the sum of squares of the other sides.\n\nExample: a=3, b=4 â†’ c = âˆš(9+16) = âˆš25 = 5 âœ“"] },
  { tag:"prime_numbers", keys:["prime","prime number","primes","composite"],
    res:["ğŸ”¢ A prime number is a natural number > 1 with no divisors except 1 and itself.\n\nFirst primes: 2, 3, 5, 7, 11, 13, 17, 19, 23...\n\nKey facts:\nâ€¢ 2 is the only even prime number\nâ€¢ There are infinitely many primes (Euclid's proof)\nâ€¢ Primes are the building blocks of all integers"] },
  { tag:"algebra", keys:["algebra","equation","variable","polynomial","quadratic","linear"],
    res:["ğŸ“ Algebra uses symbols (variables) to represent unknowns.\n\nâ€¢ Linear: ax + b = 0 â†’ x = -b/a\nâ€¢ Quadratic: axÂ² + bx + c = 0\n  â†’ x = (-b Â± âˆš(bÂ²-4ac)) / 2a\n\nAlgebra is the foundation of all advanced mathematics!"] },
  { tag:"statistics", keys:["statistics","mean","median","mode","standard deviation","variance","probability"],
    res:["ğŸ“Š Key Statistics Concepts:\n\nâ€¢ Mean: sum Ã· count\nâ€¢ Median: middle value when sorted\nâ€¢ Mode: most frequent value\nâ€¢ Variance: average of squared deviations\nâ€¢ Std Deviation: âˆšvariance (measures spread)\nâ€¢ Probability: P = favorable / total outcomes"] },
  { tag:"pi", keys:["pi","3.14","circumference","circle"],
    res:["â­• Pi (Ï€) â‰ˆ 3.14159265...\n\nRatio of a circle's circumference to its diameter.\n\nFormulas:\nâ€¢ Circumference = 2Ï€r\nâ€¢ Area = Ï€rÂ²\nâ€¢ Sphere volume = (4/3)Ï€rÂ³\n\nÏ€ is irrational â€” its decimal never ends or repeats!"] },

  // Physics
  { tag:"newton_laws", keys:["newton","law of motion","inertia","force mass","action reaction"],
    res:["âš™ï¸ Newton's Three Laws of Motion:\n\n1ï¸âƒ£ Inertia: Objects stay at rest (or in motion) unless acted on by a force.\n\n2ï¸âƒ£ F = ma: Force = Mass Ã— Acceleration.\n\n3ï¸âƒ£ Action-Reaction: Every action has an equal & opposite reaction.\n\nPublished in Principia Mathematica (1687)."] },
  { tag:"gravity", keys:["gravity","gravitation","gravitational","weight","free fall"],
    res:["ğŸŒ Gravity:\n\nâ€¢ On Earth: g = 9.8 m/sÂ² (free-fall acceleration)\nâ€¢ Newton: F = Gmâ‚mâ‚‚/rÂ²\nâ€¢ Einstein: gravity = curvature of spacetime\n\nKeeps planets in orbit, holds our atmosphere, and makes things fall!"] },
  { tag:"speed_of_light", keys:["speed of light","light speed","299792458"],
    res:["ğŸ’¡ Speed of Light: c = 299,792,458 m/s â‰ˆ 3Ã—10â¸ m/s\n\nâ€¢ ~186,000 miles per second\nâ€¢ Takes ~8 minutes: Sun â†’ Earth\nâ€¢ Einstein: c is the universe's speed limit\nâ€¢ Nothing with mass can reach or exceed c"] },
  { tag:"quantum", keys:["quantum","quantum mechanics","wave particle","superposition","uncertainty","heisenberg"],
    res:["âš›ï¸ Quantum Mechanics describes nature at atomic scales.\n\nâ€¢ Wave-particle duality: particles behave as waves AND particles\nâ€¢ Heisenberg Uncertainty: can't know position AND momentum precisely\nâ€¢ Superposition: particles exist in multiple states until measured\nâ€¢ Entanglement: particles linked regardless of distance"] },
  { tag:"thermodynamics", keys:["thermodynamics","entropy","heat","energy conservation","laws of thermodynamics"],
    res:["ğŸŒ¡ï¸ Laws of Thermodynamics:\n\n0th: Thermal equilibrium is transitive\n1st: Energy cannot be created or destroyed\n2nd: Entropy (disorder) always increases\n3rd: Absolute zero (0 K = -273.15Â°C) cannot be reached"] },

  // Chemistry
  { tag:"atom", keys:["atom","atomic","proton","neutron","electron","nucleus"],
    res:["âš›ï¸ Atomic Structure:\n\nâ€¢ Nucleus: protons (+) and neutrons (0) â€” dense core\nâ€¢ Electron cloud: electrons (-) in shells around nucleus\n\nFun fact: atoms are 99.99% empty space!\nIf nucleus = marble â†’ atom = football stadium size"] },
  { tag:"periodic_table", keys:["periodic table","elements","mendeleev","chemical element","atomic number"],
    res:["ğŸ§ª The Periodic Table: 118 known elements organized by atomic number.\n\nâ€¢ Rows = Periods (same number of electron shells)\nâ€¢ Columns = Groups (same valence electrons â†’ similar properties)\nâ€¢ Metals (left), Metalloids (middle), Non-metals (right)\n\nCreated by Mendeleev in 1869 â€” he even predicted undiscovered elements!"] },
  { tag:"photosynthesis", keys:["photosynthesis","chlorophyll","chloroplast","plant food"],
    res:["ğŸŒ¿ Photosynthesis equation:\n6COâ‚‚ + 6Hâ‚‚O + light â†’ Câ‚†Hâ‚â‚‚Oâ‚† + 6Oâ‚‚\n\nProcess:\n1. Chlorophyll absorbs sunlight\n2. Water molecules are split\n3. COâ‚‚ â†’ glucose (plant food)\n4. Oxygen released\n\nProduces the Oâ‚‚ we breathe â€” base of most food chains!"] },

  // Biology
  { tag:"dna", keys:["dna","gene","genes","chromosome","genetics","genome","deoxyribonucleic"],
    res:["ğŸ§¬ DNA (Deoxyribonucleic Acid):\n\nStructure: Double helix of nucleotide base pairs.\nBase pairing rules:\nâ€¢ Adenine (A) â†” Thymine (T)\nâ€¢ Guanine (G) â†” Cytosine (C)\n\nFacts:\nâ€¢ ~3 billion base pairs in human genome\nâ€¢ Uncoiled = ~2 meters per cell\nâ€¢ 99.9% identical between all humans!"] },
  { tag:"evolution", keys:["evolution","natural selection","darwin","species","adaptation","survival"],
    res:["ğŸ¦• Evolution by Natural Selection (Darwin, 1859):\n\n1. Variation: individuals differ in traits\n2. Heredity: traits passed to offspring\n3. Selection: favorable traits â†’ better survival & reproduction\n4. Over millions of years â†’ new species\n\nEvidence: fossils, DNA comparisons, observed speciation"] },
  { tag:"cell", keys:["cell","cells","organelle","mitochondria","ribosome","prokaryote","eukaryote"],
    res:["ğŸ”¬ Cell Biology:\n\nâ€¢ Prokaryotes: No nucleus (bacteria)\nâ€¢ Eukaryotes: Have nucleus (plants, animals, fungi)\n\nKey organelles:\nâ€¢ Nucleus: contains DNA, controls cell\nâ€¢ Mitochondria: energy production (ATP)\nâ€¢ Ribosome: builds proteins\nâ€¢ Cell membrane: controls entry/exit"] },

  // CS
  { tag:"algorithm", keys:["algorithm","sorting","binary search","bubble sort","time complexity","big o","searching"],
    res:["ğŸ’» Algorithms:\n\nSorting:\nâ€¢ Bubble Sort: O(nÂ²) â€” simple, slow\nâ€¢ Merge Sort: O(n log n) â€” divide & conquer\nâ€¢ Quick Sort: O(n log n) avg â€” fast in practice\n\nSearching:\nâ€¢ Linear Search: O(n)\nâ€¢ Binary Search: O(log n) â€” needs sorted data\n\nBig O: describes how runtime scales with input size."] },
  { tag:"oop", keys:["oop","object oriented","class","object","inheritance","encapsulation","polymorphism","abstraction"],
    res:["ğŸ’» OOP â€” 4 Pillars:\n\n1ï¸âƒ£ Encapsulation: bundle data + methods, hide internals\n2ï¸âƒ£ Inheritance: child class reuses parent code\n3ï¸âƒ£ Polymorphism: same method, different behavior\n4ï¸âƒ£ Abstraction: hide complexity, show essentials\n\nLanguages: Python, Java, C++, C#"] },
  { tag:"machine_learning", keys:["machine learning","ml","neural network","deep learning","artificial intelligence","ai","model training"],
    res:["ğŸ¤– Machine Learning â€” computers learn from data!\n\nTypes:\nâ€¢ Supervised: labeled data (e.g., spam detection)\nâ€¢ Unsupervised: finds patterns (e.g., clustering)\nâ€¢ Reinforcement: trial & reward (e.g., game AI)\n\nAlgorithms: Linear Regression, Decision Trees, Neural Networks, SVM\n\nDeep Learning: multi-layered neural networks inspired by the brain."] },
  { tag:"data_structures", keys:["data structure","array","linked list","stack","queue","tree","graph","hash table"],
    res:["ğŸ’» Data Structures:\n\nâ€¢ Array: indexed, O(1) access\nâ€¢ Linked List: nodes + pointers, O(1) insert\nâ€¢ Stack: LIFO (Last-In-First-Out)\nâ€¢ Queue: FIFO (First-In-First-Out)\nâ€¢ Tree: hierarchical (file systems, DOM)\nâ€¢ Graph: nodes + edges (maps, social networks)\nâ€¢ Hash Table: key-value, O(1) avg lookup"] },

  // History
  { tag:"ww2", keys:["world war 2","world war ii","second world war","ww2","wwii","nazi","holocaust"],
    res:["ğŸ“œ World War II (1939â€“1945):\n\nâ€¢ Causes: fascism, Nazi expansionism, appeasement\nâ€¢ 1939: Germany invades Poland â†’ war begins\nâ€¢ 1941: Pearl Harbor â†’ USA enters\nâ€¢ 1944: D-Day â€” Allied invasion of Normandy\nâ€¢ 1945: Germany surrenders (May); Japan (Aug) after atomic bombs\n\nDeadliest conflict: ~70â€“85 million deaths. Led to the UN."] },
  { tag:"ww1", keys:["world war 1","world war i","first world war","ww1","wwi","great war","archduke"],
    res:["ğŸ“œ World War I (1914â€“1918):\n\nâ€¢ Trigger: Assassination of Archduke Franz Ferdinand\nâ€¢ Trench warfare on the Western Front\nâ€¢ USA joins 1917\nâ€¢ Armistice: November 11, 1918\n\nResult: ~20 million deaths, fall of four empires, Treaty of Versailles â†’ conditions for WWII"] },
  { tag:"french_revolution", keys:["french revolution","bastille","marie antoinette","reign of terror","napoleon","robespierre"],
    res:["ğŸ“œ French Revolution (1789â€“1799):\n\nâ€¢ Causes: financial crisis, inequality, Enlightenment ideas\nâ€¢ July 14, 1789: Storming of the Bastille (France's national day)\nâ€¢ Execution of King Louis XVI & Marie Antoinette\nâ€¢ Reign of Terror under Robespierre\nâ€¢ Rise of Napoleon Bonaparte\n\nSpread democratic ideals across Europe!"] },
  { tag:"ancient_rome", keys:["rome","roman","roman empire","julius caesar","roman republic","colosseum"],
    res:["ğŸ›ï¸ Ancient Rome:\n\nâ€¢ Republic: 509â€“27 BC (Senate, consuls)\nâ€¢ Empire: 27 BCâ€“476 AD (Augustus, Nero, Marcus Aurelius)\nâ€¢ Julius Caesar: general/dictator, assassinated 44 BC\nâ€¢ Fall: 476 AD (Western Empire) â€” overextension + invasions\n\nLegacy: law, Latin, Christianity, architecture (Colosseum, roads)"] },
];

// NLTK-style tokenizer & lemmatizer (simple JS version)
const STOP = new Set(['the','a','an','in','on','at','to','for','of','and','or','but','is','are','was','were','be','been','being','have','has','had','do','does','did','will','would','could','should','may','might','shall','can','need','dare','ought','used','it','its','this','that','these','those','i','me','my','we','our','you','your','he','she','they','them','their','s','t']);

function tokenize(text) {
  return text.toLowerCase().replace(/[^\w\s]/g,'').split(/\s+/)
    .filter(t => t.length > 1 && !STOP.has(t));
}

function lemma(word) {
  // simple stemming rules
  return word.replace(/tion$|tions$/,'').replace(/ing$/,'').replace(/ies$/,'y').replace(/ed$/,'').replace(/s$/,'') || word;
}

function scoreMatch(userTokens, keyTokens) {
  if (!keyTokens.length) return 0;
  let matches = 0;
  for (const ut of userTokens) {
    const ul = lemma(ut);
    for (const kt of keyTokens) {
      if (ul === lemma(kt) || ut === kt || kt.includes(ut) || ut.includes(kt)) {
        matches++; break;
      }
    }
  }
  return matches / keyTokens.length;
}

function getResponse(input) {
  const tokens = tokenize(input);
  let bestScore = 0, bestEntry = null;

  for (const entry of KB) {
    const keyTokens = entry.keys.join(' ').split(' ');
    let score = scoreMatch(tokens, keyTokens);
    // bonus for direct substring
    for (const k of entry.keys) {
      if (input.toLowerCase().includes(k)) { score += 0.5; break; }
    }
    if (score > bestScore) { bestScore = score; bestEntry = entry; }
  }

  if (bestEntry && bestScore >= 0.1) {
    const res = bestEntry.res;
    return { tag: bestEntry.tag, score: bestScore.toFixed(2), response: res[Math.floor(Math.random()*res.length)] };
  }
  return { tag:'unknown', score:0, response:"I'm not sure about that. Try asking about: calculus, DNA, Newton's laws, machine learning, World War 2, or type 'help' for all topics!" };
}

// â”€â”€ UI Logic â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const API = 'http://localhost:5000/chat';
let msgCount = 0;

function addMsg(text, isUser, meta) {
  const wrap = document.getElementById('messages');
  const div = document.createElement('div');
  div.className = `msg ${isUser ? 'user' : 'bot'}`;

  const av = document.createElement('div');
  av.className = `avatar ${isUser ? 'user-av' : 'bot-av'}`;
  av.textContent = isUser ? 'ğŸ‘¤' : 'ğŸ“';

  const bw = document.createElement('div');
  bw.className = 'bubble-wrap';

  const bub = document.createElement('div');
  bub.className = 'bubble';
  bub.textContent = text;

  bw.appendChild(bub);

  if (!isUser && meta) {
    const m = document.createElement('div');
    m.className = 'meta';
    m.innerHTML = `<span class="tag-pill">${meta.tag}</span><span>score: ${meta.score}</span><span>nltk Â· bow</span>`;
    bw.appendChild(m);
  }

  div.appendChild(av);
  div.appendChild(bw);
  wrap.appendChild(div);
  wrap.scrollTop = wrap.scrollHeight;
  msgCount++;
}

function showTyping() {
  const wrap = document.getElementById('messages');
  const d = document.createElement('div');
  d.id = 'typing'; d.className = 'msg bot typing';
  d.innerHTML = `<div class="avatar bot-av">ğŸ“</div><div class="dots"><span></span><span></span><span></span></div>`;
  wrap.appendChild(d);
  wrap.scrollTop = wrap.scrollHeight;
}

function removeTyping() { document.getElementById('typing')?.remove(); }

async function sendMsg(text) {
  const inp = document.getElementById('inp');
  const msg = text || inp.value.trim();
  if (!msg) return;

  addMsg(msg, true);
  inp.value = ''; inp.style.height = 'auto';
  document.getElementById('sendBtn').disabled = true;
  showTyping();

  // try real backend first
  try {
    const res = await fetch(API, {
      method:'POST', headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ message: msg }),
      signal: AbortSignal.timeout(5000)
    });
    const data = await res.json();
    removeTyping();
    addMsg(data.response, false, { tag: data.tag, score: data.score });
  } catch {
    // fallback to JS demo engine
    await new Promise(r => setTimeout(r, 600 + Math.random()*400));
    removeTyping();
    const r = getResponse(msg);
    addMsg(r.response, false, { tag: r.tag + ' (demo)', score: r.score });
  }

  document.getElementById('sendBtn').disabled = false;
  document.getElementById('inp').focus();
}

function ask(text) { sendMsg(text); }

function handleKey(e) {
  if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendMsg(); }
}

function resize(el) {
  el.style.height = 'auto';
  el.style.height = Math.min(el.scrollHeight, 110) + 'px';
}

document.getElementById('inp').focus();
</script>
</body>
</html>